{"version":3,"file":"main.bundle.js","mappings":"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","sources":["webpack://bounce/./scripts/add-controls.ts","webpack://bounce/./scripts/app.ts","webpack://bounce/./scripts/ball.ts","webpack://bounce/./scripts/images.ts","webpack://bounce/./scripts/modal.ts","webpack://bounce/./scripts/utility.ts","webpack://bounce/webpack/bootstrap","webpack://bounce/webpack/runtime/define property getters","webpack://bounce/webpack/runtime/hasOwnProperty shorthand","webpack://bounce/webpack/runtime/make namespace object","webpack://bounce/./scripts/index.ts"],"sourcesContent":["import { addModal } from \"./modal\";\nconst controlHtml =\n  '<!-- Thumbnail container -->' +\n  '<section id=\"ball-select\" class=\"balls-container\">' +\n  '<section id=\"ball-scroll-controls\" class=\"btn-scroll-container\">' +\n  '<button id=\"img-up\" class=\"btn-scroll bounce-button\">&#9650;</button>' +\n  '<button id=\"img-down\" class=\"btn-scroll bounce-button\">&#9660;</button>' +\n  '</section>' +\n  '<section id=\"bounce-img-container\" class=\"bounce-img-container\"></section>' +\n  '</section>' +\n  '<!-- Button controls -->' +\n  '<section id=\"button-controls\" class=\"btn-container\">' +\n  '<button id=\"image-upload-btn\" class=\"btn-ctrl bounce-button\">' +\n  '<span class=\"material-icons\">add_photo_alternate</span></button>' +\n  '<button id=\"party-btn\" class=\"btn-ctrl bounce-button\">' +\n  '<span class=\"material-icons\">celebration</span></button>' +\n  '<button id=\"gravity-btn\" class=\"btn-ctrl btn-gravity bounce-button\">G</button>' +\n  '</section>';\n\nconst canvasHtml =\n  '<canvas id=\"canvas\" class=\"bounce-canvas\">' +\n  \"Your browser doesn't support canvas.\" +\n  '</canvas>';\n\nexport const insertBounceElements = () => {\n  const container = document.querySelector('.bounce-container');\n  const controlElement = document.createElement('section');\n  controlElement.id = 'app-controls';\n  controlElement.classList.add('controls');\n  controlElement.innerHTML = controlHtml;\n\n  const canvasELement = document.createElement('section');\n  canvasELement.classList.add('canvas-container');\n  canvasELement.innerHTML = canvasHtml;\n\n  const modal = addModal();\n\n  container?.append(controlElement, canvasELement, modal);\n}","import { Ball } from \"./ball\";\nimport { imageList, addImage, imageCache } from \"./images\";\nimport { Velocity } from \"./types\";\nimport { util } from \"./utility\";\n\nexport const appProps = {\n  count: 0,\n  radiusSizes: { s: 40, m: 40, l: 50, current: 50 },\n  screenBreakPoints: { l: 1280, m: 768 },\n  gravity: { value: 0.01, isOn: false, btn: document.getElementById('gravity-btn') },\n  balls: <Ball[]>[],\n  selectedImgEle: <HTMLImageElement | null>null,\n  selectedBall: <Ball | null>null,\n  selectedPositions: {\n    prev: { x: 0, y: 0 },\n    current: { x: 0, y: 0 },\n    reference: { x: 0, y: 0 }\n  },\n  selectedAngleThreshold: 10,\n  mouseMoveDistThreshold: 10,\n  velocityThreshould: 0.05,\n  overlapThreshold: 0.05,\n  wallModifiers: { left: 1.1, right: 1.1, top: 1, bottom: 1.8 },\n  currentTime: 0,\n  selectedTime: 0,\n  deceleration: 0.995,\n  canvas: <HTMLCanvasElement>document.getElementById('canvas'),\n  canvasHorizontalGap: 5 * 2,\n  canvasTopOffset: 70,\n  party: {\n    isActive: false, start: 0, duration: 10000, maxVelocity: 2, minVelocity: 0.5,\n    wallModRef: { left: 1, right: 1, top: 1, bottom: 1 },\n    gravityRef: true, colourRef: <[number, number][]>[],\n    partyBtn: document.getElementById('party-btn')!\n  },\n  rainBow: ['#ff0000', '#ffa500', '#ffff00', '#008000', '#0000ff', '#4b0082', '#ee82ee'] //rainbow colours\n};\n\nexport function init(): void {\n  appProps.canvas = <HTMLCanvasElement>document.getElementById('canvas');\n  appProps.gravity.btn = document.getElementById('gravity-btn');\n  addEventListeners();\n  //set initial canvas dimensions\n  setSizes();\n  // Load all the images in the image list\n  Promise.all(\n    imageList.map(img => addImage(\n      img, imageCache, 50)\n    )\n  ).then(_ => {\n    appProps.currentTime = new Date().getTime();\n    window.requestAnimationFrame(draw);\n  });\n};\n\n/**\n * Add event handlers for the canvas.\n */\nfunction addEventListeners(): void {\n  window.onresize = () => {\n    setSizes();\n  };\n  appProps.canvas.addEventListener('pointerdown', onMouseDown);\n  appProps.canvas.addEventListener('pointermove', onMouseMove);\n  appProps.canvas.addEventListener('pointerup', onMouseUp);\n  appProps.canvas.addEventListener('pointerleave', onMouseLeave);\n\n  const gravityBtn = document.getElementById('gravity-btn');\n  //toggle the colour of the text on the gravity button.\n  gravityBtn?.addEventListener('click',\n    function toggleGravity() {\n      if (appProps.party.isActive) return;\n      appProps.gravity.isOn = !appProps.gravity.isOn;\n      toggleGravityBtn(appProps.gravity.isOn);\n    }\n  );\n  //start the party.\n  document.getElementById('party-btn')?.addEventListener('click', () => {\n    party();\n  })\n}\n\nfunction toggleGravityBtn(isOn: boolean) {\n  if (isOn) {\n    appProps.gravity.btn?.classList.add('bounce-selected');\n  } else {\n    appProps.gravity.btn?.classList.remove('bounce-selected');\n  }\n}\n\n/**\n * Change the canvas dimensions and the ball radius sizes\n * everytime the browser is resized.\n */\nfunction setSizes(): void {\n  try {\n    if (appProps.canvas === null) throw new Error('canvas is null');\n    const width = window.innerWidth - 50;\n    const height = window.innerHeight - 30;\n\n    if (width < appProps.screenBreakPoints.m) {\n      appProps.radiusSizes.current = appProps.radiusSizes.s;\n    } else if (width < appProps.screenBreakPoints.l) {\n      appProps.radiusSizes.current = appProps.radiusSizes.m;\n    } else {\n      appProps.radiusSizes.current = appProps.radiusSizes.l;\n    }\n\n    appProps.canvas.width = width - appProps.canvasHorizontalGap;\n    appProps.canvas.height = height - appProps.canvasTopOffset;\n\n    appProps.balls.forEach(ball => ball.radius = appProps.radiusSizes.current);\n  } catch (err) {\n    console.error(err);\n  }\n}\n\n\n/**\n * Remove the selected ball from the ball array\n */\nfunction deleteBall(ballToDelete: Ball) {\n  try {\n    const index = appProps.balls.findIndex(ball => ball.id === ballToDelete.id);\n    if (index === -1) {\n      throw new Error(`ball of id:${ballToDelete.id} could not be found.`);\n    } else {\n      appProps.balls.splice(index, 1);\n    }\n  } catch (err) {\n    console.error(err);\n  }\n}\n\nfunction createAndStoreBall(\n  imgEle: HTMLImageElement,\n  x: number,\n  y: number,\n  radius = appProps.radiusSizes.current,\n  selected = false\n): Ball | undefined {\n  try {\n    const imgIndex = Number(imgEle.dataset['index']);\n    const ball = new Ball(imageCache[imgIndex], x, y, radius, selected);\n    appProps.balls.push(ball);\n    appProps.count++;\n    //Update colour reference if created during party mode.\n    if (appProps.party) {\n      appProps.party.colourRef[ball.id] = [Math.floor(Math.random() * appProps.rainBow.length), 0];\n    }\n    return ball;\n  } catch (err) {\n    console.error(err);\n  }\n}\n\n/**\n * Draw each frame\n */\nfunction draw() {\n  const ctx = appProps.canvas.getContext('2d')!;\n  const ellapsedTime = new Date().getTime() - appProps.currentTime;\n  appProps.currentTime = new Date().getTime();\n\n  //Check and update the party conditions.\n  if (appProps.party.isActive) {\n    ctx.fillStyle = 'rgba(220, 219, 6, 0.1)';\n    ctx.fillRect(0, 0, appProps.canvas.width, appProps.canvas.height);\n    const ellapsedPartyTime = new Date().getTime() - appProps.party.start;\n    //party btn backgroup position as percentage value\n    let partyBtnBGPos = ellapsedPartyTime / appProps.party.duration * 100;\n    if (ellapsedPartyTime > appProps.party.duration) {\n      partyBtnBGPos = 0;\n      appProps.party.isActive = false;\n      appProps.wallModifiers = { ...appProps.party.wallModRef };\n      appProps.gravity.isOn = appProps.party.gravityRef;\n      toggleGravityBtn(appProps.gravity.isOn);\n      appProps.party.colourRef = [];\n    } else {\n      //update the ball border colours after each second.\n      appProps.party.colourRef.forEach((val, idx) => {\n        appProps.party.colourRef[idx] = [val[0], ellapsedPartyTime];\n      })\n    }\n    setEleBackGroundPosition(appProps.party.partyBtn, partyBtnBGPos);\n  } else {\n    ctx.clearRect(0, 0, appProps.canvas.width, appProps.canvas.height);\n  }\n\n  //draw each of the balls and then update its position.\n  appProps.balls.forEach(ball => {\n    if (!ball.selected) {\n      drawBall(ctx, ball);\n    }\n    updateBall(ball, ellapsedTime);\n\n  })\n\n  fixBallOverlaps(appProps.balls);\n  appProps.balls.forEach(ball => {\n    if (!ball.selected) {\n      ball.rotation += calcBallRotation(ball);\n    }\n  })\n  //draw selected ball last so it shows up on top.\n  drawBall(ctx, appProps.selectedBall);\n\n  window.requestAnimationFrame(() => { draw() });\n}\n\n/**\n * update the ball's state after each frame.\n */\nfunction updateBall(ball: Ball, ellapsedTime: number) {\n  let { position, selected, velocity } = ball;\n  if (!selected) {\n    ball.prevPosition = { ...position };\n    const halfGravity = appProps.gravity.value / 3;\n    if (Math.abs(ball.velocity.vX) < halfGravity) ball.velocity.vX = 0;\n    if (Math.abs(ball.velocity.vY) < halfGravity) ball.velocity.vY = 0;\n    appProps.gravity.isOn && (velocity.vY += appProps.gravity.value);\n    const distX = velocity.vX * ellapsedTime;\n    position.x += distX;\n    position.y += velocity.vY * ellapsedTime;\n    velocity.vX *= appProps.deceleration;\n    handleBallCollissions(ball);\n    handleWallCollissions(ball);\n  }\n}\n/**\n * Adjust the position of the ball based on the nearest ball collission\n */\nfunction handleBallCollissions(ball: Ball): void {\n  let collisions = <Ball[]>[];\n  appProps.balls.forEach(ball2 => {\n    if (ball.id !== ball2.id && !ball2.selected) {\n      if (ball.getOverlap(ball2) > appProps.overlapThreshold) collisions.push(ball2);\n    }\n  })\n  //sort collision by distance between balls and then handle them sequentially.\n  if (collisions.length > 0) {\n    collisions.sort((a, b) => {\n      const distA = util.distanceBetween2Points(ball.position, a.position);\n      const distB = util.distanceBetween2Points(ball.position, b.position);\n      return distA - distB;\n    })\n\n    // let collidingBalls = [ball, collisions[0]];\n\n    ball.reversePosition(ball.getOverlap(collisions[0]));\n    const [v1, v2] = ballsBounce(ball, collisions[0]);\n    ball.velocity = v1;\n    collisions[0].velocity = v2;\n    // ball.ballBounce(collisions[0]);\n  }\n  collisions = [];\n}\n\n/**\n * calculate the velocity after two balls collide.\n */\nfunction ballsBounce(ball1: Ball, ball2: Ball): [Velocity, Velocity] {\n  let ball1V = { ...ball1.velocity };\n  let ball2V = { ...ball2.velocity };\n  if (ball1.checkBallCollision(ball2)) {\n    ball1V = util.getBallCollisionVelocity(ball1, ball2);\n    ball2V = util.getBallCollisionVelocity(ball2, ball1);\n  }\n  return [ball1V, ball2V];\n}\n\n/**\n * Check to see if a ball collides with a side wall.\n */\nfunction handleWallCollissions(ball: Ball): void {\n  const { position, radius, velocity } = ball;\n  const { canvas, wallModifiers } = appProps;\n  //right\n  if (position.x + radius > canvas.width) {\n    position.x = canvas.width - radius;\n    velocity.vX < 0 || (ball.velocity.vX *= -1 / wallModifiers['right']);\n    if (Math.abs(velocity.vX) < 0.05) velocity.vX = 0;\n  }\n\n  //left\n  if (position.x - radius < 0) {\n    position.x = radius;\n    velocity.vX > 0 || (ball.velocity.vX *= -1 / wallModifiers['left']);\n    if (Math.abs(velocity.vX) < 0.05) velocity.vX = 0;\n  }\n\n  //bottom\n  if (position.y + radius > canvas.height) {\n    position.y = canvas.height - radius;\n    velocity.vY < 0 || (ball.velocity.vY *= -1 / wallModifiers['bottom']);\n    if (Math.abs(velocity.vY) < 0.05) velocity.vY = 0;\n  }\n\n  //top\n  if (position.y - radius < 0) {\n    position.y = radius;\n    velocity.vY > 0 || (ball.velocity.vY *= -1 / wallModifiers['top']);\n  }\n}\n\n/**\n * Sort the list of balls base on position on the canvas.\n * Bottom to top, left to right.\n */\nfunction sortBalls(balls: Ball[]): Ball[] {\n  let sortedBallList = <Ball[]>[];\n\n  balls.forEach(ball => {\n    let listPosition = sortedBallList.findIndex(ball2 => {\n      if (ball.position.y > ball2.position.y) return true;\n      if (ball.position.y === ball2.position.y && ball.position.x < ball2.position.x) return true;\n      return false;\n    })\n    listPosition === -1 ? sortedBallList.push(ball) : sortedBallList.splice(listPosition, 0, ball);\n  })\n\n  return sortedBallList;\n}\n\n\n/**\n * check and fix any overlaps between balls after \n * handling wall and ball collisions\n */\nfunction fixBallOverlaps(balls: Ball[]) {\n  let sortedBallList = sortBalls(balls);\n  sortedBallList.forEach(ball => {\n    !ball.selected && sortedBallList.forEach(ball2 => {\n      if (ball2.selected) return;\n      const overlap = ball.getOverlap(ball2);\n      if (overlap < appProps.overlapThreshold) return;\n      const distanceOnYAxis = ball.position.y - ball2.position.y;\n      if (ball.id !== ball2.id && overlap > 0.03) {\n        const [x, y] = util.xyDiffBetweenPoints(ball.position, ball2.position);\n        const total = Math.abs(x) + Math.abs(y);\n        const xRatio = (x / total) * overlap;\n        const yRatio = (y / total) * overlap;\n        if (distanceOnYAxis === 0) {\n          ball.position.x -= 0.5 * overlap;\n          ball2.position.x += 0.5 * overlap;\n        } else {\n          distanceOnYAxis > 0 ?\n            (ball2.position.x += xRatio,\n              ball2.position.y += yRatio) :\n            (ball.position.x += xRatio,\n              ball.position.y += yRatio);\n        }\n      }\n    })\n  })\n}\n\n/**\n * Draw an individual ball.\n */\nfunction drawBall(ctx: CanvasRenderingContext2D, ball: Ball | null) {\n  if (ball === null) return;\n  const { id, position, radius, selected, rotation, img } = ball;\n  ctx.save();\n  ctx.translate(position.x, position.y);\n  ctx.rotate(Math.PI / 180 * rotation);\n  ctx.drawImage(img, -radius, -radius, radius * 2, radius * 2);\n\n  if (appProps.party.isActive) {\n    ctx.lineWidth = Math.round(radius / 10) + 1;\n    ctx.strokeStyle = appProps.rainBow[(appProps.party.colourRef[id][0]\n      + Math.floor(appProps.party.colourRef[id][1] / 1000)) % appProps.rainBow.length];\n    ctx.beginPath();\n    ctx.arc(0, 0, radius, 0, Math.PI * 2);\n    ctx.stroke();\n  }\n\n  if (selected) {\n    ctx.lineWidth = 4\n    ctx.strokeStyle = 'cyan'\n    ctx.beginPath()\n    ctx.arc(0, 0, radius, 0, Math.PI * 2)\n    ctx.stroke()\n  }\n  ctx.restore();\n}\n\nfunction calcBallRotation(ball: Ball): number {\n  const parameter = 2 * Math.PI * ball.radius;\n  const dist = ball.position.x - ball.prevPosition.x;\n  const rotation = dist / parameter;\n  return rotation * 360;\n}\n\nfunction party() {\n  appProps.party.start = new Date().getTime();\n  document.getElementById('party-btn')?.classList.add('btn-progress-bar')\n  if (appProps.party.isActive) {\n    appProps.balls.forEach(ball => {\n      ball.velocity = partyBallVelocity();\n    });\n    return;\n  }\n\n  appProps.party.gravityRef = appProps.gravity.isOn;\n  appProps.gravity.isOn = false;\n  toggleGravityBtn(appProps.gravity.isOn);\n  appProps.party.wallModRef = { ...appProps.wallModifiers };\n  appProps.wallModifiers = { left: 1, right: 1, top: 1, bottom: 1 };\n  appProps.party.isActive = true;\n  appProps.balls.forEach(ball => {\n    //randomly assign one of the rainbow colours to a ball at the start.\n    appProps.party.colourRef[ball.id] = [Math.floor(Math.random() * appProps.rainBow.length), 0];\n    ball.velocity = partyBallVelocity();\n  })\n}\n\n//randomise velocity for party balls.\nfunction partyBallVelocity(min: number = appProps.party.maxVelocity, max: number = appProps.party.minVelocity): Velocity {\n  let signX = -1, signY = -1;\n  if (Math.random() > 0.5) signX = 1;\n  if (Math.random() > 0.5) signY = 1;\n  return {\n    vX: Math.max((Math.random() * max), min) * signX,\n    vY: Math.max((Math.random() * max), min) * signY\n  };\n}\n\n/**\n * Set the x position of the Element's backgroup position property as a percentage.\n */\nfunction setEleBackGroundPosition(ele: HTMLElement, pos: number) {\n  ele.style.backgroundPosition = `${pos}% 100%`;\n}\n\n/**\n * Get the position of the mouse click \n * relative to the canvas\n */\nfunction getRelativeMousePos(evt: MouseEvent): [number, number] {\n  const boundingRect = (<HTMLElement>evt.target).getBoundingClientRect();\n  return [evt.clientX - boundingRect.x, evt.clientY - boundingRect.y];\n}\n\n//\n// Mouse Controls for canvas\n//\n\nfunction onMouseDown(evt: MouseEvent) {\n  if (evt.button !== 0) return; //not primary click\n  const [x, y] = getRelativeMousePos(evt);\n  if (appProps.selectedImgEle) {\n    appProps.selectedBall = createAndStoreBall(appProps.selectedImgEle, x, y) || null;\n  } else {\n    appProps.selectedBall = appProps.balls.find(ball => ball.containsPoint(x, y)) || null;\n  }\n\n  if (appProps.selectedBall) {\n    //set the initial values for properties use to calcuate the \n    //velocity of the selected ball at release.\n    appProps.selectedTime = new Date().getTime();\n    appProps.selectedBall.selected = true;\n    appProps.selectedBall.velocity = { vX: 0, vY: 0 };\n    appProps.selectedPositions.current = { x, y };\n    appProps.selectedPositions.prev = { x, y };\n    appProps.selectedPositions.reference = { x, y };\n  }\n}\n\nfunction onMouseMove(evt: MouseEvent) {\n  if (appProps.selectedBall) {\n    const [x, y] = getRelativeMousePos(evt);\n    const [moveX, moveY] = util.xyDiffBetweenPoints(appProps.selectedPositions.current, { x, y });\n    appProps.selectedBall.move(moveX, moveY);\n    appProps.selectedPositions.current = { x, y };\n\n    const distance = util.distanceBetween2Points({ x, y }, appProps.selectedPositions.prev);\n\n    //if the angle between the 3 points is greater than a certain amount\n    //assign the current position as the new reference point for velocity.\n    if (distance > appProps.mouseMoveDistThreshold) {\n      const { reference, prev, current } = appProps.selectedPositions;\n      const angle = util.angleBetween3Points(reference, prev, current) || 0;\n      if (angle > appProps.selectedAngleThreshold) {\n        appProps.selectedPositions.reference = { x, y };\n        appProps.selectedTime = new Date().getTime();\n      }\n      appProps.selectedPositions.prev = { x, y };\n    }\n  }\n}\n\n/**\n * Calculate ellapsed time and final mouse position and use it to \n * adjust the velocity for the selected ball\n */\nfunction onMouseUp(evt: MouseEvent) {\n  if (appProps.selectedBall) {\n    try {\n      const [x, y] = getRelativeMousePos(evt);\n      const [distX, distY] = util.xyDiffBetweenPoints(appProps.selectedPositions.reference, { x, y });\n\n      const ellapsedTime = new Date().getTime() - appProps.selectedTime;\n\n      appProps.selectedBall.velocity.vX = distX / ellapsedTime;\n      appProps.selectedBall.velocity.vY = distY / ellapsedTime;\n    } catch (err) {\n      appProps.selectedBall.position = { x: 50, y: 50 };\n      console.error(err);\n    }\n    appProps.selectedBall.selected = false;\n    appProps.selectedBall = null;\n  }\n}\n\nfunction onMouseLeave(evt: MouseEvent) {\n  if (appProps.selectedBall) {\n    appProps.selectedBall.selected = false;\n    appProps.selectedBall.velocity = { vX: 0, vY: 0 };\n    appProps.selectedBall = null;\n  }\n}","import { Point, Velocity } from \"./types\";\nimport { util } from \"./utility\";\n\nexport class Ball {\n  private static baseId = 1;\n  readonly id: number;\n  position: Point;\n  prevPosition: Point;\n  radius: number;\n  rotation: number;\n  velocity: Velocity;\n  selected: boolean;\n  // The img associated with an instance of Ball\n  img: ImageBitmap;\n\n  constructor(img: ImageBitmap, x: number, y: number, r: number, selected: boolean = false) {\n    this.id = Ball.baseId;\n    this.position = { x, y };\n    this.prevPosition = { x, y };\n    this.radius = r;\n    this.rotation = 0;\n    this.velocity = { vX: 0, vY: 0 }\n    this.img = img;\n    this.selected = selected;\n    Ball.baseId++;\n  }\n\n  /**\n   * move the ball by x and y amount.\n   */\n  move(x: number, y: number): void {\n    this.position.x += x;\n    this.position.y += y;\n  }\n\n  /**\n   * Reverse the position of the ball\n   * by a given distance in the opposite direction\n   * of its velocity.\n   */\n  reversePosition(distance: number): void {\n    if (this.getTotalVelocity() === 0) {\n    } else {\n      const velocityRatio = Math.sqrt(Math.pow(distance, 2) / (Math.pow(this.velocity.vX, 2) + Math.pow(this.velocity.vY, 2))) * -1;\n      this.position.x += this.velocity.vX * velocityRatio;\n      this.position.y += this.velocity.vY * velocityRatio;\n    }\n  }\n\n  getTotalVelocity(): number {\n    return Math.sqrt(Math.pow(this.velocity.vX, 2) + Math.pow(this.velocity.vY, 2));\n  }\n\n  containsPoint(x: number, y: number): boolean {\n    return Math.pow(x - this.position.x, 2) + Math.pow(y - this.position.y, 2) <= Math.pow(this.radius, 2);\n  }\n\n  /**\n   * The overlap between this instance of ball and another ball\n   */\n  getOverlap(otherBall: Ball): number {\n    const centerDistance = util.distanceBetween2Points(this.position, otherBall.position);\n    const sumOfRadii = this.radius + otherBall.radius;\n    const overlap = sumOfRadii - centerDistance;\n    return overlap >= 0 ? overlap : -1;\n  }\n\n  /**\n   * Check if this ball is colliding against another ball\n   * It's consider colliding if the overlap between the two balls is\n   * greater than or equal to 0 and the angle between the velocity vectors is less \n   * than 90 degrees.\n   */\n  checkBallCollision(ball2: Ball): boolean {\n    if (this.getOverlap(ball2) >= 0) {\n      const centerToCenter = util.xyDiffBetweenPoints(this.position, ball2.position);\n      const angle = util.angleBetween2DVector(this.velocity.vX, this.velocity.vY, centerToCenter[0], centerToCenter[1]) || 0;\n      return angle <= 90;\n    }\n    return false;\n  }\n\n  //return circle representation of the ball.\n  getCircle() {\n    return { ...this.position, r: this.radius };\n  }\n\n}","import { appProps } from \"./app\";\nimport { util } from \"./utility\";\nexport const imageList = (function () {\n\n  const imageFiles = <string[]>[\"me.jpeg\", \"grumpy.webp\", \"smileface.webp\", \"spongebob.webp\", \"pepper.png\"];\n  const imageUrls = <string[]>[];\n  const path = \"https://raw.githubusercontent.com/seegg/bounce/main/images/\";\n\n  return imageFiles.map(img => path + img).concat(imageUrls);\n\n})();\n\n//image thumbnail container\nlet container = <HTMLElement>document.getElementById('bounce-img-container');\n\n//set up image scroll controls\nexport const setUpImages = () => {\n  container = <HTMLElement>document.getElementById('bounce-img-container');\n  document.getElementById('ball-scroll-controls')?.addEventListener('pointerdown', imgContainerScrollUpDown);\n}\n\n//Keeps track of the bitmaps created from imageList and input image url and image files.\nexport let imageCache = <ImageBitmap[]>[];\n\n/**\n * Add an image base on a input url. create a bitmap and HTMLImageElement base on this image.\n * store the bitmap to an array and append the img element to the img container.\n * @param imgSrc URL for the image\n * @param imgArr Array to store the bmp created base on the image url\n * @param radius The radius of the bitmap \n * @param imgContainer The HTMLElement containing the image selection.\n * @param callback event handler for click event on the img element\n */\nexport function addImage(\n  imgSrc: string,\n  imgArr: ImageBitmap[],\n  radius: number,\n  imgContainer: HTMLElement = container\n) {\n  // const classList = ['img-thumb', 'rounded-full', 'filter', 'object-contain', 'h-12', 'w-12', 'filter', 'grayscale'];\n  const classList = ['bounce-img-thumb', 'grayscale'];\n  // const imgContainer = document.getElementById('img-container');\n  const loadingPlaceholder = document.createElement('img');\n  loadingPlaceholder.classList.add('bounce-img-thumb');\n  loadingPlaceholder.src = 'images/spinner.gif';\n  imgContainer?.appendChild(loadingPlaceholder);\n  return util.createCircleImg(imgSrc, radius)\n    .then(bitmapImg => {\n      const index = imgArr.push(bitmapImg) - 1;\n      return createImgEleWithIndex(imgSrc, index, classList)\n    })\n    .then(imgEle => {\n      if (imgContainer === null) throw new Error('image container is null');\n      appendImgElemToContainer(imgEle, imgContainer, loadingPlaceholder);\n    })\n    .catch(err => {\n      imgContainer?.removeChild(loadingPlaceholder);\n      console.error(err);\n    })\n}\n\n/**\n * Append a HTMLImageELement to a parent container\n * optional loading placeholder.\n */\nexport function appendImgElemToContainer(imgEle: HTMLImageElement, imgContainer: HTMLElement, loadingImg?: HTMLImageElement): void {\n  if (loadingImg) {\n    imgContainer.replaceChild(imgEle, loadingImg);\n  } else {\n    imgContainer.append(imgEle);\n  }\n}\n\n/**\n *create a new HTMLImageElement with a src and a list of classes.\n *assign an index number from the bitmap image array associated with \n *the src.\n */\nexport function createImgEleWithIndex(\n  src: string,\n  imgIndex: number,\n  classList: string[]\n): HTMLImageElement {\n  const imgEle = document.createElement('img');\n  imgEle.classList.add(...classList);\n  imgEle.onclick = ({ target }) => { toggleSelectedImgElement(<HTMLImageElement>target) };\n  imgEle.setAttribute('data-index', imgIndex + '');\n  imgEle.onload = () => {\n    URL.revokeObjectURL(src);\n  }\n  imgEle.src = src;\n  return imgEle;\n}\n\n/**\n * Toggle/Select the img elements \n * in the img container\n */\nexport function toggleSelectedImgElement(imgEle: HTMLImageElement) {\n  const grayscale = 'grayscale';\n  appProps.selectedImgEle?.classList.toggle(grayscale);\n  if (imgEle === appProps.selectedImgEle) {\n    appProps.selectedImgEle = null;\n  } else {\n    imgEle.classList.toggle(grayscale);\n    appProps.selectedImgEle = imgEle;\n  }\n  scrollToImgElement(imgEle);\n}\n\nexport function scrollToImgElement(imgEle: HTMLImageElement) {\n  const container = document.getElementById('bounce-img-container')!;\n  const scrollDistance = imgEle.getBoundingClientRect().top - container.getBoundingClientRect().top + container.scrollTop;\n  container.scroll(0, scrollDistance);\n}\n\nexport function imgContainerScrollUpDown(evt: Event, imgContainer: HTMLElement = container, imgThumbnailSize: number = 48) {\n  evt.preventDefault();\n\n  /**\n   * Get the mod of the scroll position against the thumbnail size.\n   * On scroll up, set the scroll position to the current position minus the thumbnail size\n   * and minus any remainders from the mod operation.\n   * On scroll down, add thumbnail size to the current position and then\n   * minus the remainder from the new position.\n   * The remainder helps to line up image thumbnails in the image container.\n   */\n  const remainder = imgContainer.scrollTop % imgThumbnailSize;\n  switch ((<HTMLElement>evt.target).id) {\n    case 'img-up':\n      imgContainer.scroll(0, remainder === 0 ? imgContainer.scrollTop - imgThumbnailSize : imgContainer.scrollTop - remainder)\n      break;\n    case 'img-down':\n      imgContainer.scroll(0, imgContainer.scrollTop + imgThumbnailSize - remainder)\n      break;\n  }\n}\n","import { appProps } from \"./app\";\nimport { addImage, imageCache } from \"./images\";\n\n\n\nexport const modalInit = () => {\n\n  const imageUploadModal = {\n    modal: document.getElementById('modal'),\n    overlay: document.getElementById('modal-overlay'),\n    openButton: document.getElementById('image-upload-btn'),\n    /** \n     * open/close modal\n     */\n    toggle: () => {\n      imageUploadModal.modal?.classList.toggle('close');\n      imageUploadModal.overlay?.classList.toggle('close');\n    }\n  }\n\n  /**\n   * image upload form for the modal\n   */\n  const imageForm = {\n    form: document.getElementById('image-upload-form'),\n    okButton: document.getElementById('form-ok-btn'),\n    imgFileInput: <HTMLInputElement>document.getElementById('img-file'),\n    imgURLInput: <HTMLInputElement>document.getElementById('img-URL'),\n    imgFileDisplay: <HTMLInputElement>document.getElementById('file-name'),\n    imgFileDisplayButton: <HTMLButtonElement>document.getElementById('upload-button'),\n    cancelButton: document.getElementById('form-cancel-btn'),\n    handleFileDisplayClick: (evt: Event) => {\n      evt.preventDefault();\n      imageForm.imgFileInput.click();\n    },\n    handleFileChange: () => {\n      imageForm.imgFileDisplay.value = imageForm.imgFileInput.files?.item(0)?.name || 'No Image Selected';\n    },\n    handleSubmit: (evt: Event) => {\n      evt.preventDefault();\n      let imgSrc = ''\n      if (imageForm.imgFileInput.files?.item(0)) {\n        try {\n          imgSrc = URL.createObjectURL(imageForm.imgFileInput.files[0]);\n        } catch (e) {\n          console.error(e);\n        }\n      } else {\n        imgSrc = imageForm.imgURLInput.value;\n      }\n\n      addImage(imgSrc, imageCache, appProps.radiusSizes.current)\n        .then(_ => {\n          console.log('whatever');\n          imageUploadModal.toggle();\n        })\n        .catch(err => {\n          console.log('something');\n        })\n    },\n    handleCancel: (evt: Event) => {\n      imageForm.imgURLInput.value = '';\n      imageForm.imgFileInput.value = '';\n      imageForm.imgFileDisplay.value = '';\n      imageUploadModal.toggle();\n    }\n  }\n\n  imageUploadModal.overlay?.addEventListener('click', imageUploadModal.toggle);\n  imageUploadModal.openButton?.addEventListener('click', imageUploadModal.toggle);\n  imageForm.form?.addEventListener('submit', imageForm.handleSubmit);\n  imageForm.imgFileDisplayButton.addEventListener('click', imageForm.handleFileDisplayClick);\n  imageForm.imgFileInput.addEventListener('change', imageForm.handleFileChange);\n  imageForm.cancelButton?.addEventListener('click', imageForm.handleCancel);\n  //close modal on esc\n  document.addEventListener('keydown',\n    function closeModal(evt: KeyboardEvent) {\n      if (imageUploadModal.modal?.classList.contains('close')) return;\n      if (evt.key === 'Escape') {\n        imageUploadModal.toggle();\n      }\n    })\n}\n\nexport const addModal = () => {\n  const modalHtml =\n    '<form id=\"image-upload-form\" class=\"upload-form\">' +\n    '<h2 class=\"-bounce-title\">Upload Image</h2>' +\n    '<input class=\"bounce-input\" hidden type=\"file\" id=\"img-file\" name=\"imgFile\" accept=\"image/*\">' +\n\n    '<section class=\"img-upload\">' +\n    '<label for=\"fileName\" class=\"font-bold\">Image File:</label>' +\n    '<section class=\"img-file-display\">' +\n    '<input class=\"bounce-input\" readonly type=\"text\" name=\"fileName\" placeholder=\"No file selected\"' +\n    'id=\"file-name\">' +\n    '<button type=\"button\" class=\"btn-file bounce-button\" id=\"upload-button\">Select Image</button>' +\n    '</section>' +\n    '</section>' +\n\n    '<section class=\"img-upload\">' +\n    '<label for=\"imgUrl\" class=\"font-bold\">Image URL:</label>' +\n    '<section>' +\n    '<input class=\"bounce-input\" type=\"text\" name=\"imgURL\" id=\"img-URL\" placeholder=\"Image URL\">' +\n    '</section>' +\n    '</section>' +\n\n    '<section class=\"upload-controls\">' +\n    '<button type=\"submit\" class=\"mx-1 bounce-button btn-ctrl\" id=\"form-ok-btn\"><span class=\"material-icons\">' +\n    'check</span></button>' +\n    '<button type=\"button\" class=\"mx-1 bounce-button btn-ctrl\" id=\"form-cancel-btn\"><span class=\"material-icons\">' +\n    'close</span></button>' +\n    '</section>' +\n    '</form>';\n\n  const modalOverlay = document.createElement('div');\n  modalOverlay.innerHTML = '<div class=\"modal-overlay close\" id=\"modal-overlay\"></div>';\n\n  const modalElement = document.createElement('section');\n  modalElement.id = 'modal';\n  modalElement.classList.add('upload-modal', 'close');\n  modalElement.innerHTML = modalHtml;\n\n  const modalFragment = new DocumentFragment();\n  modalFragment.append(modalElement, modalOverlay);\n  return modalFragment;\n}","import { Ball } from \"./ball\";\nimport { Velocity, Circle, Point } from './types';\n\n/**\n * returns the new velocity of object1 after collision with object2\n * https://en.wikipedia.org/wiki/Elastic_collision#Two-dimensional_collision_with_two_moving_objects\n * @param x1 x center object1\n * @param y1 y center object1\n * @param vx1 x velocity object1\n * @param vy1 y velocity object1\n * @param x2 x center object2\n * @param y2 y center object2\n * @param vx2 x velocity object2\n * @param vy2 y veloicity object2\n * @param mass1 mass object1\n * @param mass2 mass object2\n */\nfunction calculateCollisionVelocity(\n  x1: number, y1: number,\n  vx1: number, vy1: number,\n  x2: number, y2: number,\n  vx2: number, vy2: number,\n  mass1?: number, mass2?: number\n): Velocity {\n  const mass = mass1 && mass2 ? (2 * mass2) / (mass1 + mass2) : 1;\n  const distX = x1 - x2;\n  const distY = y1 - y2;\n  const vxDelta = vx1 - vx2;\n  const vyDelta = vy1 - vy2;\n  const dotProduct = (distX * vxDelta) + (distY * vyDelta);\n  const magnitude = Math.pow(distX, 2) + Math.pow(distY, 2);\n  const sc = dotProduct / magnitude * mass;\n\n  const newVx = vx1 - (sc * distX);\n  const newVy = vy1 - (sc * distY);\n  return { vX: newVx, vY: newVy };\n}\n\n/**\n * returns the velocity of ball1 after colliding with ball2.\n */\nfunction getBallCollisionVelocity(ball1: Ball, ball2: Ball) {\n  return calculateCollisionVelocity(ball1.position.x, ball1.position.y, ball1.velocity.vX, ball1.velocity.vY,\n    ball2.position.x, ball2.position.y, ball2.velocity.vX, ball2.velocity.vY);\n}\n/**\n * returns the difference between x and y axis of two points\n * from origin to destination.\n * Will return negative values depenping on the orientation of the points.\n */\nfunction xyDiffBetweenPoints(origin: Point, destination: Point): [number, number] {\n  return [destination.x - origin.x, destination.y - origin.y];\n}\n\n/**\n * Draw an image to a temp HTMLCanvas element\n * crop image to circle with globalCompositeOperation = 'destination-in'\n * returns a promise that resolves to an bitmap of the canvas picture.\n * @param imgScr image src\n * @param radius radius of the output circle image\n * @param outlineColour the outline colour of the circle\n */\nfunction createCircleImg(imgScr: string, radius: number, outlineColour: string = 'white', outlineSize: number = 3): Promise<ImageBitmap> {\n  return new Promise((resolve, reject) => {\n    const tempCanvas = document.createElement('canvas');\n    const diameter = radius * 2;\n    tempCanvas.width = diameter;\n    tempCanvas.height = diameter;\n    const image = document.createElement('img');\n    image.src = imgScr;\n    image.onload = () => {\n      //Calculate width and height of image in proportion to canvas size \n      //so the new image doesn't look distorted.\n      const wRatio = image.width / diameter;\n      const hRatio = image.height / diameter;\n      wRatio >= hRatio ? tempCanvas.width = Math.floor(image.width / hRatio) : tempCanvas.height = Math.floor(image.height / wRatio);\n\n      const adjustedImage = stepDownImage(image, { w: diameter, h: diameter });\n\n      const ctx = tempCanvas.getContext('2d');\n      if (ctx === null) throw new Error('context2D is null');\n      ctx.drawImage(adjustedImage, 0, 0, tempCanvas.width, tempCanvas.height);\n      ctx.beginPath();\n      ctx.arc(tempCanvas.width / 2, tempCanvas.height / 2, radius, 0, Math.PI * 2);\n      ctx.closePath();\n      ctx.lineWidth = outlineSize;\n      ctx.strokeStyle = outlineColour;\n      ctx.stroke();\n      ctx.globalCompositeOperation = 'destination-in';\n      ctx.arc(tempCanvas.width / 2, tempCanvas.height / 2, radius, 0, Math.PI * 2);\n      ctx.fill();\n      resolve(createImageBitmap(tempCanvas, tempCanvas.width / 2 - radius, tempCanvas.height / 2 - radius, diameter, diameter));\n    }\n    image.onerror = reject\n  })\n}\n\n/**\n * Downscale an image in incremental steps using 2 HTMLcanvas by halving\n * the size of the image each time for better results.\n * @param image The input HTMLImageElement.\n * @param targetSize The size of the output image.\n */\nfunction stepDownImage(image: HTMLImageElement, targetSize: { w: number, h: number }): HTMLCanvasElement {\n\n  //draw the image to an offscreen canvas.\n  const canvas = document.createElement('canvas');\n  canvas.height = image.height;\n  canvas.width = image.width;\n  const ctx = canvas.getContext('2d')!;\n  ctx.drawImage(image, 0, 0, canvas.width, canvas.height);\n\n  //get the number of steps to be performed base on the largest dimension\n  const wRatio = image.width / targetSize.w;\n  const hRatio = image.height / targetSize.h;\n  const steps = Math.ceil(Math.log(wRatio >= hRatio ? hRatio : wRatio) / Math.log(2))\n\n  //halve the image with a second at each step until just before the final step.\n  const canvas2 = document.createElement('canvas');\n  const ctx2 = canvas2.getContext('2d')!;\n  for (let i = 1; i < steps; i++) {\n    canvas2.width = canvas.width / 2;\n    canvas2.height = canvas.height / 2;\n    ctx2.drawImage(canvas, 0, 0, canvas2.width, canvas2.height);\n    canvas.width = canvas2.width;\n    canvas.height = canvas2.height;\n    ctx.drawImage(canvas2, 0, 0);\n  }\n\n  //final step, draw the image to the desired size.\n  canvas2.width = targetSize.w;\n  canvas2.height = targetSize.h;\n  ctx2.drawImage(canvas, 0, 0, canvas2.width, canvas2.height);\n\n  return canvas2;\n}\n\n/**\n * Use HTMLCanvasElement.toBlob to convert a bitmap to a blob with a different mime type.\n * CORS problems from canvas if using images from different domain.\n * @param image the input bitmap\n * @param mimeType the mimeType for the blob, default image/png\n */\nfunction convertBmpToBlob(image: ImageBitmap, mimeType: string = 'image/png'): Promise<Blob | null> {\n  return new Promise((resolve, reject) => {\n    const canvas = document.createElement('canvas');\n    canvas.width = image.width;\n    canvas.height = image.height;\n    const ctx = canvas.getContext('bitmaprenderer');\n    if (ctx) {\n      ctx.transferFromImageBitmap(image);\n    } else {\n      canvas.getContext('2d')?.drawImage(image, 0, 0);\n    }\n    canvas.toBlob(function blobCallback(blob) {\n      if (blob === null) reject('Blob is null');\n      resolve(blob);\n    })\n  })\n}\n\nfunction distanceBetween2Points(point1: Point, point2: Point): number {\n  const [diffX, diffY] = xyDiffBetweenPoints(point1, point2);\n  return Math.sqrt(Math.pow(diffX, 2) + Math.pow(diffY, 2));\n}\n\nfunction angleBetween2DVector(vx1: number, vy1: number, vx2: number, vy2: number): number {\n\n  const dotProduct = (vx1 * vx2) + (vy1 * vy2);\n  const magnitude1 = Math.sqrt(Math.pow(vx1, 2) + Math.pow(vy1, 2));\n  const magnitude2 = Math.sqrt(Math.pow(vx2, 2) + Math.pow(vy2, 2));\n  return Math.acos(dotProduct / (magnitude1 * magnitude2)) * (180 / Math.PI);\n}\n\nfunction angleBetween3Points(start: Point, mid: Point, end: Point): number {\n  return angleBetween2DVector(mid.x - start.x, mid.y - start.y, end.x - mid.x, end.y - mid.y);\n}\n\n/**\n * Return the maximum VERTICAL distance within the intersection between two circles\n * by calculating the intersect of a line down the middle of the intersection with\n * the two circles.\n * Return 0 if no intersection or if the circles intersects at only one point.\n */\nfunction maxIntersectHeight(circle1: Circle, circle2: Circle): number {\n  const distBetweenCenters = distanceBetween2Points({ x: circle1.x, y: circle1.y }, { x: circle2.x, y: circle2.y });\n  let overlappingDistance = distBetweenCenters - circle1.r - circle2.r;\n  if (overlappingDistance >= 0) return 0;\n\n  //The start and end point of the line use for calculating intersection.\n  //The start point is the mid point of the overlapping region of the two circles.\n  //The end point is created by moving 1 unit on the y axis from the start point.\n  //The line is treated as extending infinitely in either directions for the purpose of the calculation.\n\n  const midIntersectDistance = circle1.r + (overlappingDistance * 0.5);\n  const distRatio = midIntersectDistance / distBetweenCenters;\n  const startPoint = {\n    x: ((1 - distRatio) * circle1.x) + (distRatio * circle2.x),\n    y: ((1 - distRatio) * circle1.y) + (distRatio * circle2.y)\n  };\n\n  const endPoint = { ...startPoint, y: startPoint.y + 1 };\n  const [c1IntersecCount, c1Intersect1, c1Intersec2] = circleLineIntersect(startPoint, endPoint, circle1);\n  const [c2IntersectCount, c2Intersect1, c2Intersect2] = circleLineIntersect(startPoint, endPoint, circle2);\n\n  //sort the y axis positions of intersection and use the 2 middle values to calculate the\n  //max length of the overlap.\n  const yIntersects = [c1Intersect1!.y, c1Intersec2!.y, c2Intersect1!.y, c2Intersect2!.y].sort();\n  return yIntersects[2] - yIntersects[1];\n}\n\n/**\n * Return the maximum HORIZONTAL distance within the intersection between two circles\n * by calculating the intersect of a line across the middle of the intersection with\n * the two circles.\n * Return 0 if no intersection or if the circles intersects at only one point.\n */\nfunction maxIntersectWidth(circle1: Circle, circle2: Circle): number {\n  const distBetweenCenters = distanceBetween2Points({ x: circle1.x, y: circle1.y }, { x: circle2.x, y: circle2.y });\n  let overlappingDistance = distBetweenCenters - circle1.r - circle2.r;\n  if (overlappingDistance >= 0) return 0;\n  //The start and end point of the line use for calculating intersection.\n  //The start point is the mid point of the overlapping region of the two circles.\n  //The end point is created by moving 1 unit on the x axis from the start point.\n  //The line is treated as extending infinitely in either directions for the purpose of the calculation.\n\n  const midIntersectDistance = circle1.r + (overlappingDistance * 0.5);\n  const distRatio = midIntersectDistance / distBetweenCenters;\n  const startPoint = {\n    x: ((1 - distRatio) * circle1.x) + (distRatio * circle2.x),\n    y: ((1 - distRatio) * circle1.y) + (distRatio * circle2.y)\n  };\n\n  const endPoint = { ...startPoint, x: startPoint.x + 1 };\n  const [c1IntersecCount, c1Intersect1, c1Intersec2] = circleLineIntersect(startPoint, endPoint, circle1);\n  const [c2IntersectCount, c2Intersect1, c2Intersect2] = circleLineIntersect(startPoint, endPoint, circle2);\n\n  //sort the x axis positions of intersection and use the 2 middle values to calculate the\n  //max length of the overlap.\n  const xIntersects = [c1Intersect1!.x, c1Intersec2!.x, c2Intersect1!.x, c2Intersect2!.x].sort();\n  return xIntersects[2] - xIntersects[1];\n}\n\n/**\n * @returns The number of points and the points themselves where the line intersects with the circle. \n * No intersection 0, tangent 1 else 2.\n *\n */\nfunction circleLineIntersect(lineStart: Point, lineEnd: Point, circle: Circle): [number, Point | null, Point | null] {\n  //translate the coordinates of the line with the center of the circle as origin.\n  const translatedStart = { x: lineStart.x - circle.x, y: lineStart.y - circle.y };\n  const translatedEnd = { x: lineEnd.x - circle.x, y: lineEnd.y - circle.y };\n\n  // console.log(translatedStart, translatedEnd);\n  const dx = translatedEnd.x - translatedStart.x;\n  const dy = translatedEnd.y - translatedStart.y;\n  const dr = distanceBetween2Points(translatedStart, translatedEnd);\n  const D = (translatedStart.x * translatedEnd.y) - (translatedEnd.x * translatedStart.y);\n\n  const sgnDy = dy < 0 ? -1 : 1;\n  const rSquared = Math.pow(circle.r, 2);\n  const drSquared = Math.pow(dr, 2);\n  const DSquared = Math.pow(D, 2);\n  // console.log(dx, dy);\n  const discriminant = rSquared * drSquared - DSquared;\n  const numberOfIntersections = discriminant < 0 ? 0 : discriminant === 0 ? 1 : 2;\n  // console.log(discriminant);\n  if (discriminant < 0) return [numberOfIntersections, null, null];\n  // console.log('what');\n  const sqrtResult = Math.sqrt(discriminant);\n\n\n  //calculat intersecting points and translate it back to original corrodinates.\n  const x1 = ((D * dy) + (sgnDy * dx * sqrtResult)) / drSquared + circle.x;\n  const y1 = ((-1 * D * dx) + (Math.abs(dy) * sqrtResult)) / drSquared + circle.y;\n\n  const x2 = ((D * dy) - (sgnDy * dx * sqrtResult)) / drSquared + circle.x;\n  const y2 = ((-1 * D * dx) - (Math.abs(dy) * sqrtResult)) / drSquared + circle.y;\n\n  let intersect1 = { x: x1, y: y1 };\n  let intersect2 = { x: x2, y: y2 };\n\n  if (x1 > x2 || (x1 === x2 && y1 > y2)) {\n    intersect2 = { ...intersect1 };\n    intersect1 = { x: x2, y: y2 };\n  }\n\n  return [numberOfIntersections, intersect1, discriminant === 0 ? null : intersect2];\n}\n\nexport const util = {\n  calculateCollisionVelocity,\n  createCircleImg,\n  convertBmpToBlob,\n  getBallCollisionVelocity,\n  xyDiffBetweenPoints,\n  angleBetween2DVector,\n  angleBetween3Points,\n  distanceBetween2Points,\n  circleLineIntersect,\n  maxIntersectHeight,\n  maxIntersectWidth\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { init } from \"./app\";\nimport { setUpImages } from \"./images\";\nimport { modalInit } from \"./modal\";\nimport { insertBounceElements } from './add-controls';\n\ninsertBounceElements();\nsetUpImages();\nmodalInit();\ninit();\n"],"names":["insertBounceElements","container","document","querySelector","controlElement","createElement","id","classList","add","innerHTML","canvasELement","modal","addModal","append","appProps","count","radiusSizes","s","m","l","current","screenBreakPoints","gravity","value","isOn","btn","getElementById","balls","selectedImgEle","selectedBall","selectedPositions","prev","x","y","reference","selectedAngleThreshold","mouseMoveDistThreshold","velocityThreshould","overlapThreshold","wallModifiers","left","right","top","bottom","currentTime","selectedTime","deceleration","canvas","canvasHorizontalGap","canvasTopOffset","party","isActive","start","duration","maxVelocity","minVelocity","wallModRef","gravityRef","colourRef","partyBtn","rainBow","init","window","onresize","setSizes","addEventListener","onMouseDown","onMouseMove","onMouseUp","onMouseLeave","gravityBtn","toggleGravityBtn","Date","getTime","forEach","ball","velocity","partyBallVelocity","Math","floor","random","length","addEventListeners","Promise","all","imageList","img","addImage","imageCache","then","_","requestAnimationFrame","draw","remove","Error","width","innerWidth","height","innerHeight","radius","err","console","error","ele","pos","sortedBallList","ctx","getContext","ellapsedTime","fillStyle","fillRect","ellapsedPartyTime","partyBtnBGPos","val","idx","style","backgroundPosition","clearRect","selected","drawBall","position","prevPosition","halfGravity","abs","vX","vY","distX","collisions","ball2","getOverlap","push","sort","a","b","util","reversePosition","ball1","ball1V","ball2V","checkBallCollision","ballsBounce","v1","v2","handleBallCollissions","handleWallCollissions","updateBall","listPosition","findIndex","splice","sortBalls","overlap","distanceOnYAxis","total","xRatio","yRatio","rotation","parameter","PI","calcBallRotation","save","translate","rotate","drawImage","lineWidth","round","strokeStyle","beginPath","arc","stroke","restore","min","max","signX","signY","getRelativeMousePos","evt","boundingRect","target","getBoundingClientRect","clientX","clientY","button","imgEle","imgIndex","Number","dataset","Ball","createAndStoreBall","find","containsPoint","moveX","moveY","move","distY","r","this","baseId","distance","getTotalVelocity","velocityRatio","sqrt","pow","otherBall","centerDistance","centerToCenter","map","concat","setUpImages","imgContainerScrollUpDown","imgSrc","imgArr","imgContainer","loadingPlaceholder","src","appendChild","bitmapImg","index","createImgEleWithIndex","appendImgElemToContainer","removeChild","loadingImg","replaceChild","onclick","toggleSelectedImgElement","setAttribute","onload","URL","revokeObjectURL","grayscale","toggle","scrollToImgElement","scrollDistance","scrollTop","scroll","imgThumbnailSize","preventDefault","remainder","modalInit","imageUploadModal","overlay","openButton","imageForm","form","okButton","imgFileInput","imgURLInput","imgFileDisplay","imgFileDisplayButton","cancelButton","handleFileDisplayClick","click","handleFileChange","files","item","name","handleSubmit","createObjectURL","e","log","handleCancel","contains","key","modalOverlay","modalElement","modalFragment","DocumentFragment","calculateCollisionVelocity","x1","y1","vx1","vy1","x2","y2","vx2","vy2","mass1","mass2","mass","sc","xyDiffBetweenPoints","origin","destination","stepDownImage","image","targetSize","wRatio","w","hRatio","h","steps","ceil","canvas2","ctx2","i","distanceBetween2Points","point1","point2","diffX","diffY","angleBetween2DVector","dotProduct","magnitude1","magnitude2","acos","circleLineIntersect","lineStart","lineEnd","circle","translatedStart","translatedEnd","dx","dy","dr","D","sgnDy","rSquared","drSquared","discriminant","numberOfIntersections","sqrtResult","intersect1","intersect2","createCircleImg","imgScr","outlineColour","outlineSize","resolve","reject","tempCanvas","diameter","adjustedImage","closePath","globalCompositeOperation","fill","createImageBitmap","onerror","convertBmpToBlob","transferFromImageBitmap","toBlob","blob","getBallCollisionVelocity","angleBetween3Points","mid","end","maxIntersectHeight","circle1","circle2","distBetweenCenters","overlappingDistance","distRatio","startPoint","endPoint","c1Intersect1","c1Intersec2","c2Intersect1","c2Intersect2","yIntersects","maxIntersectWidth","xIntersects","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","d","definition","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag"],"sourceRoot":""}